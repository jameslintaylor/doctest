# Is this useful in Clojure?

This tool can be used to assert that a var's documented usage examples, i.e. doctests, do not speak folly.

Is this useful in Clojure? That's entirely up to you. You might prefer to use `comment` blocks or `:test` metadata, or do away with this fluff entirely and live out a happy and care-free existence.

If you like the idea, but take exception to this particular tool, presumably for its lack of pizazz, you may find solace in one of these Clojure libraries that vow to do precisely the same thing:
- https://github.com/drojas/doctest
- https://github.com/Kobold/clj-doc-test

## Usage

Scan your `./src` directory and generate doctests:

```
$ clj -m jameslintaylor.doctest
Generated tests in ./target/doctest/
```

## Test format

Upon encountering a var with `Usage:` doc examples, e.g.:

```clojure
(ns jameslintaylor.example)

(defn foo
  "I don't do a whole lot.

  Usage:

  => (foo 1)
  :foo

  foo always returns :foo
  => (foo nil)
  :foo

  => (= (foo 1) (foo 2))
  true"
  [_]
  :foo)
```

Doctest will generate a corresponding test, e.g.:

```clojure
(ns jameslintaylor.example-doctest
  "Generated by doctest."
  (:require
   [clojure.test :refer [deftest is]]
   [jameslintaylor.doctest :refer [foo]]))

(deftest ^:doctest foo-test
  (is (= :foo
         (foo 1)))
  (is (= :foo
         (foo nil))
      "foo always returns :foo")
  (is (= true
         (clojure.core/= (foo 1) (foo 2)))))
```

## Running the generated tests

Add `./target/doctest` as an extra path to your test runner of choice and run your tests as you would otherwise.
